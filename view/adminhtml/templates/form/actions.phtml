<?php
declare(strict_types=1);

/** @version 0.6.0 */

use Loki\AdminComponents\Form\Field\Field;
use Loki\CssUtils\Util\CssClass;
use Magento\Framework\Escaper;
use Magento\Framework\View\Element\Template;
use Loki\AdminComponents\Component\Form\FormViewModel;
use Loki\Components\Util\Block\ChildRenderer;

/** @var Escaper $escaper */
/** @var Template $block */
/** @var Field $field */
/** @var FormViewModel $viewModel */
/** @var ChildRenderer $childRenderer */
/** @var CssClass $css */

$viewModel = $block->getViewModel();
$buttons = $viewModel->getButtons();
$mainSaveAction = false;
$otherSaveActions = [];
?>
<div class="page-main-actions">
    <div class="page-actions-placeholder"></div>

    <div class="page-actions">
        <div class="page-actions-inner">
            <div class="page-actions-buttons">
                <?php foreach ($buttons as $button) : ?>
                    <?php $subButtons = $button->getSubButtons(); ?>
                    <button
                        @click.prevent="<?= $escaper->escapeHtml($button->getMethod()) ?>"
                        title="<?= $escaper->escapeHtml(__($button->getLabel())) ?>"
                        type="button"
                        class="action- scalable <?= $escaper->escapeHtml($button->getCssClass()) ?>">
                        <span><?= $escaper->escapeHtml(__($button->getLabel())) ?></span>
                    </button>
                <?php endforeach; ?>

                <?php if (!empty($otherSaveActions)) : ?>
                    <div
                        title="Save and Continue"
                        class="actions-split save primary"
                    >
                        <button
                            @click.prevent="saveAndContinueAction"
                            title="Save and Continue"
                            class="action-default primary"
                        >
                            <span>Save and Continue</span>
                        </button>

                        <button @click.prevent="toggleOtherActions"
                                title="Save and Continue"
                                class="action-toggle primary save">
                            <span>Select</span>
                        </button>

                        <ul
                            class="dropdown-menu"
                            x-cloak x-show="showOtherActions"
                        >
                            <?php foreach (
                                $otherSaveActions as $otherSaveAction
                            ): ?>
                                <li>
                                    <span
                                        @click.prevent="saveAndDuplicateAction"
                                        title="Save &amp; Duplicate"
                                        class="item"
                                    >
                                        Save &amp;amp; Duplicate
                                    </span>
                                </li>
                            <?php endforeach; ?>
                        </ul>
                    </div>
                <?php endif; ?>
            </div>
        </div>
    </div>

    <style>
        .loki-form .dropdown-menu {
            display: block;
        }
    </style>
</div>
