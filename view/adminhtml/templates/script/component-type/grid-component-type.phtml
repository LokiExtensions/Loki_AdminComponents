<?php
declare(strict_types=1);

use Magento\Framework\View\Element\Template;

/** @version 0.3.3 */
/** @var Template $block */
?>
<script>
    const LokiAdminGridComponentType = {
        ...LokiAdminPaginationComponentPartial,
        ...LokiAdminLimitComponentPartial,
        ...LokiAdminInlineEditComponentPartial,
        ...LokiAdminSelectedComponentPartial,
        ...LokiAdminColumnsSelectorComponentPartial,
        ...LokiAdminViewSelectorComponentPartial,
        ...LokiAdminFiltersComponentPartial,
        ...LokiAdminMassActionsComponentPartial,
        ...LokiComponentType,
        columns: {},
        columnPositions: {},
        showOtherActions: false,
        gridFilters: {},
        toggleOtherActions() {
            this.showOtherActions = !this.showOtherActions;
        },
        setGridFilter() {
            const value = this.$el.value;
            const nameParts = this.$el.getAttribute('data-name').split('.');
            if (nameParts.length > 1) {
                this.gridFilters[nameParts[0]][nameParts[1]] = value;
            } else {
                this.gridFilters[nameParts[0]] = value;
            }
        },
        applyFilters() {
            this.post({filters: this.gridFilters});
        },
        clearFilters() { // @todo: Rename to clearGridFilters
            this.post({
                clearFilters: true
            });
        },
        removeFilter() { // @todo: Rename to removeGridFilter
            const targetFilter = this.$el.getAttribute('data-field');
            if (!targetFilter) {
                return;
            }

            this.post({
                removeFilter: targetFilter
            });
        },
        sortColumn(event) {
            if (!event) {
                return;
            }

            this.post({
                sort: {
                    sortBy: this.$el.getAttribute('data-column'),
                    sortDirection: this.sortDirection === 'ASC' ? 'DESC' : 'ASC',
                }
            });
        },
        newUrl: '',
        newAction() {
            window.location.href = this.newUrl;
        },
        redirectAction() {
            window.location.href = this.$el.getAttribute('data-url');
        },
        changeSearch(event) {
            if (!event) {
                return;
            }

            this.post({search: this.$el.value});
        },

    }
</script>
